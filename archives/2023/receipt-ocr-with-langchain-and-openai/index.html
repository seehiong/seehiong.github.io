<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    




    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.b989f0fdae3971a3effd81d6d0b27b3cb1023ff0b601ff43e2118b0d9d82ddb9.js"></script>





  
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-5PNPM4HWQ0"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-5PNPM4HWQ0');
        }
      </script>

    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/favicon.png>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Tech Blog - Receipt OCR with LangChain, OpenAI and PyTesseract</title>
<meta property="og:title" content=Tech&#32;Blog&#32;-&#32;Receipt&#32;OCR&#32;with&#32;LangChain,&#32;OpenAI&#32;and&#32;PyTesseract />
<meta name="twitter:title" content=Tech&#32;Blog&#32;-&#32;Receipt&#32;OCR&#32;with&#32;LangChain,&#32;OpenAI&#32;and&#32;PyTesseract />
<meta itemprop="name" content=Tech&#32;Blog&#32;-&#32;Receipt&#32;OCR&#32;with&#32;LangChain,&#32;OpenAI&#32;and&#32;PyTesseract />
<meta name="application-name" content=Tech&#32;Blog&#32;-&#32;Receipt&#32;OCR&#32;with&#32;LangChain,&#32;OpenAI&#32;and&#32;PyTesseract />
<meta property="og:site_name" content="See Hiong&#39;s Blog" />


<meta name="description" content="Embarking on a receipt OCR adventure inspired by the LangChain for LLM Application Development course, I explore the synergy of LangChain, OpenAI, and PyTesseract. With PyTesseract, I unlock OCR potential using OpenCV and showcase code for comprehensive text extraction. Integrating OpenAI, I create a prompt to merge and format OCR results. LangChain&#39;s LLM-Math tool joins the fray, verifying OCR accuracy by calculating and comparing amounts. Witness the power of combining these technologies for precise receipt data extraction and validation. Dive into the journey, explore the code, and enhance your data processing skills!" />
<meta itemprop="description" content="Embarking on a receipt OCR adventure inspired by the LangChain for LLM Application Development course, I explore the synergy of LangChain, OpenAI, and PyTesseract. With PyTesseract, I unlock OCR potential using OpenCV and showcase code for comprehensive text extraction. Integrating OpenAI, I create a prompt to merge and format OCR results. LangChain&#39;s LLM-Math tool joins the fray, verifying OCR accuracy by calculating and comparing amounts. Witness the power of combining these technologies for precise receipt data extraction and validation. Dive into the journey, explore the code, and enhance your data processing skills!" />
<meta property="og:description" content="Embarking on a receipt OCR adventure inspired by the LangChain for LLM Application Development course, I explore the synergy of LangChain, OpenAI, and PyTesseract. With PyTesseract, I unlock OCR potential using OpenCV and showcase code for comprehensive text extraction. Integrating OpenAI, I create a prompt to merge and format OCR results. LangChain&#39;s LLM-Math tool joins the fray, verifying OCR accuracy by calculating and comparing amounts. Witness the power of combining these technologies for precise receipt data extraction and validation. Dive into the journey, explore the code, and enhance your data processing skills!" />
<meta name="twitter:description" content="Embarking on a receipt OCR adventure inspired by the LangChain for LLM Application Development course, I explore the synergy of LangChain, OpenAI, and PyTesseract. With PyTesseract, I unlock OCR potential using OpenCV and showcase code for comprehensive text extraction. Integrating OpenAI, I create a prompt to merge and format OCR results. LangChain&#39;s LLM-Math tool joins the fray, verifying OCR accuracy by calculating and comparing amounts. Witness the power of combining these technologies for precise receipt data extraction and validation. Dive into the journey, explore the code, and enhance your data processing skills!" />


<base href="https://seehiong.github.io/archives/2023/receipt-ocr-with-langchain-and-openai/" />
<link rel="canonical" href="https://seehiong.github.io/archives/2023/receipt-ocr-with-langchain-and-openai/" itemprop="url" />
<meta name="url" content="https://seehiong.github.io/archives/2023/receipt-ocr-with-langchain-and-openai/" />
<meta name="twitter:url" content="https://seehiong.github.io/archives/2023/receipt-ocr-with-langchain-and-openai/" />
<meta property="og:url" content="https://seehiong.github.io/archives/2023/receipt-ocr-with-langchain-and-openai/" />


<meta property="og:updated_time" content="2023-06-06T20:00:00&#43;08:00" />


<link rel="sitemap" type="application/xml" title="Sitemap" href='https://seehiong.github.io/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />



<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="See Hiong&#39;s Blog" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />






<meta name="generator" content="Hugo 0.134.1">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.95cc0677a25232434df79a1cf0ee059633a97da88b4235a87f2a69bea2c1e24d.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5a5a5a;
        --link-color: #268bd2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #fff;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #eee;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9d9d9d;
        --link-color: #268bd2;
        --date-color: #9a9a9a;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #fff;
        --code-background-color: #515151;
        --code-block-color: #fff;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
        
            <a href="https://seehiong.github.io/">
                <h1>Tech Blog</h1>
            </a>
        
    </h1>
    <p class="lead">
    Chronicling my personal expedition of technology exploration and experimentation, facilitated by a home-based self-configured laboratory
    </p>
</div>

        <link href="/pagefind/pagefind-ui.css" rel="stylesheet">
<style>
    :root {
        --pagefind-ui-primary: #eeeeee;
        --pagefind-ui-text: #eeeeee;
        --pagefind-ui-background: #152028;
        --pagefind-ui-border: #152028;
        --pagefind-ui-tag: #152028;
    }
</style>
<script src="/pagefind/pagefind-ui.js"></script>
<div style="max-width: 100%; margin: clamp(2px, 1vw, 10px) auto;">
    <div id="search"></div>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            new PagefindUI({ element: "#search", showSubResults: true, showImages: false });
        });
    </script>
</div>
        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/2025/">2025</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="https://seehiong.github.io/2025/mnist-data-set/">MNIST Digit Classifier in TensorFlow</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://seehiong.github.io/2025/chat-driven-insights-with-chartjs/">Chat-Driven Insights with Chart.js</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://seehiong.github.io/2025/jmc-java-performance-profiling-simplified/">JMC: Java Performance Profiling Simplified</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="https://seehiong.github.io/2025/building-a-vuejs-frontend-for-combinatorial-optimization-problem/">Building a Vue.js Frontend for Combinatorial Optimization Problems</a>
                            </li>
                        
                    
                
            
                
                
            
                
                
            
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
            
                
                
                    <li class="heading">
                        <a href="/archives/">Archives</a>
                    </li>
                    
                
            
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
            
                
                
                    <li class="heading">
                        <a href="/about/">About</a>
                    </li>
                    
                
            
                
                
            
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com/seehiong">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="LinkedIn" href="https://www.linkedin.com/in/seehiong">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>















    <a target="_blank" class="social" title="RSS Feed" href="/2025/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>





        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2025 See Hiong. All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post" data-pagefind-body>
  <div class="info">
  <h1 class="post-title">
    <a href="https://seehiong.github.io/archives/2023/receipt-ocr-with-langchain-and-openai/">Receipt OCR with LangChain, OpenAI and PyTesseract</a>
  </h1>

  <div class="headline" data-pagefind-ignore>
    <div>
      
      
      <time datetime=" 2023-06-06T20:00:00&#43;0800" class="post-date">
        June 6, 2023
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>7 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-OpenAI">
        <a href="https://seehiong.github.io/tags/openai">OpenAI</a>
      </li>
      
      <li class="tag-LangChain">
        <a href="https://seehiong.github.io/tags/langchain">LangChain</a>
      </li>
      
      <li class="tag-OCR">
        <a href="https://seehiong.github.io/tags/ocr">OCR</a>
      </li>
      
      <li class="tag-PyTesseract">
        <a href="https://seehiong.github.io/tags/pytesseract">PyTesseract</a>
      </li>
      
      <li class="tag-AI">
        <a href="https://seehiong.github.io/tags/ai">AI</a>
      </li>
      
      <li class="tag-OpenCV">
        <a href="https://seehiong.github.io/tags/opencv">OpenCV</a>
      </li>
      
      <li class="tag-LLM-Math">
        <a href="https://seehiong.github.io/tags/llm-math">LLM-Math</a>
      </li>
      
    </ul>
    
  </div>

  
  
  <p class="author">
    Author: <i>See Hiong</i>
  </p>
  

  

  
</div>

  <p>Recently, I embarked on an exhilarating journey into the realm of receipt OCR using LangChain and OpenAI, inspired by the captivating course on <a href="https://learn.deeplearning.ai/langchain/lesson/1/introduction" target="_blank">LangChain for LLM Application Development</a>. This exploration allowed me to unlock the full potential of PyTesseract, an extraordinary Python tool that serves as my guiding light for optical character recognition (OCR). By harnessing the power of OpenCV and seamlessly integrating OpenAI into the workflow, I aimed to compile the most optimal OCR results and validate them using LangChain&rsquo;s impressive llm-math tool. Join me on this exciting adventure as we unravel the intricacies of receipt OCR and discover the true potential of LangChain, OpenAI, and PyTesseract.</p>
<hr>
<h2 id="pytesseract--harnessing-optical-character-recognition-power">PyTesseract:  Harnessing Optical Character Recognition Power</h2>
<p>To begin my exploration, I first ensured I had all the necessary tools at my disposal. Depending on the operating system, the <a href="https://github.com/UB-Mannheim/tesseract/wiki" target="_blank">Tesseract installer for Windows</a> can be downloaded from here. With the installation complete, I equipped myself with essential Python packages by executing the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pip install pytesseract pillow opencv<span style="color:#f92672">-</span>python
</span></span></code></pre></div><p>Now that everything was set, I put PyTesseract to the test using a sample receipt. Here&rsquo;s a glimpse of the image we&rsquo;ll be working with:</p>
<p><img src="/images/ocr/sample-receipt-ocr.jpeg" alt="sample-receipt-ocr"></p>
<p>To witness the capabilities of PyTesseract firsthand, I present you with the following code snippet:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pytesseract
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Defines the abosulate path to the executable</span>
</span></span><span style="display:flex;"><span>pytesseract<span style="color:#f92672">.</span>pytesseract<span style="color:#f92672">.</span>tesseract_cmd <span style="color:#f92672">=</span> <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:/Program Files/Tesseract-OCR/tesseract.exe&#39;</span>
</span></span><span style="display:flex;"><span>file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;C:/ocr/sample-receipt-ocr.jpeg&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>img <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(file)
</span></span><span style="display:flex;"><span>print(pytesseract<span style="color:#f92672">.</span>image_to_string(img))
</span></span></code></pre></div><p>Running this code for the first time, I eagerly awaited the results:</p>
<p><img src="/images/ocr/tesseract-ocr-first-run.png" alt="tesseract-ocr-first-run.png"></p>
<p>Join me on this exciting journey as we delve deeper into the remarkable capabilities of PyTesseract, uncovering its potential to extract text from images with unparalleled precision and accuracy.</p>
<hr>
<h2 id="pytesseract-and-opencv-unleashing-combined-power">Pytesseract and OpenCV: Unleashing Combined Power</h2>
<p>As I continued my exploration with the sample receipt, I refined my code to generate a comprehensive dictionary containing the OCR results obtained through various methods. Let me share with you the code responsible for this accomplishment:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pytesseract
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> cv2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set Tesseract executable path</span>
</span></span><span style="display:flex;"><span>pytesseract<span style="color:#f92672">.</span>pytesseract<span style="color:#f92672">.</span>tesseract_cmd <span style="color:#f92672">=</span> <span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;C:/Program Files/Tesseract-OCR/tesseract.exe&#39;</span>
</span></span><span style="display:flex;"><span>file <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;C:/ocr/sample-receipt-ocr.jpeg&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">perform_ocr</span>(image, name):
</span></span><span style="display:flex;"><span>    text <span style="color:#f92672">=</span> pytesseract<span style="color:#f92672">.</span>image_to_string(image)
</span></span><span style="display:flex;"><span>    ocr_results<span style="color:#f92672">.</span>append({<span style="color:#e6db74">&#39;name&#39;</span>: name, <span style="color:#e6db74">&#39;text&#39;</span>: text})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Read the image using OpenCV</span>
</span></span><span style="display:flex;"><span>cvImage <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>imread(file)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Initialize OCR results list</span>
</span></span><span style="display:flex;"><span>ocr_results <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Perform OCR on the original image</span>
</span></span><span style="display:flex;"><span>fileImage <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>open(file)
</span></span><span style="display:flex;"><span>perform_ocr(fileImage, <span style="color:#e6db74">&#39;FILE&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Perform OCR on the OpenCV image</span>
</span></span><span style="display:flex;"><span>perform_ocr(cvImage, <span style="color:#e6db74">&#39;CV&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Perform OCR on the grayscale image</span>
</span></span><span style="display:flex;"><span>gray <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>cvtColor(cvImage, cv2<span style="color:#f92672">.</span>COLOR_BGR2GRAY)
</span></span><span style="display:flex;"><span>perform_ocr(gray, <span style="color:#e6db74">&#39;GRAY&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Perform OCR on the thresholded image</span>
</span></span><span style="display:flex;"><span>_, threshold <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>threshold(gray, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">255</span>, cv2<span style="color:#f92672">.</span>THRESH_BINARY <span style="color:#f92672">|</span> cv2<span style="color:#f92672">.</span>THRESH_OTSU)
</span></span><span style="display:flex;"><span>perform_ocr(threshold, <span style="color:#e6db74">&#39;THRESHOLD&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Perform OCR on the denoised image</span>
</span></span><span style="display:flex;"><span>denoised <span style="color:#f92672">=</span> cv2<span style="color:#f92672">.</span>medianBlur(cvImage, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>perform_ocr(denoised, <span style="color:#e6db74">&#39;DENOISED&#39;</span>)
</span></span></code></pre></div><p>Throughout this process, I meticulously experimented with different methods to extract the text from the receipt.
With each method, I added the results to a dictionary, capturing both the name of the method and the corresponding OCR output.</p>
<hr>
<h2 id="openai-unleashing-language-model-power">OpenAI: Unleashing Language Model Power</h2>
<p>Allow me to introduce the next phase of our exploration: OpenAI. We have carefully crafted a prompt that will guide us through
the integration of OpenAI into our OCR (Optical Character Recognition) use case:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>template_string <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;The ocr_result variable stores a list of results obtained from the OCR (Optical Character Recognition) process. </span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">Each item in the list represents a specific configuration or variation of the OCR process, along with the corresponding extracted text.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Please compare and merge the OCR results only when you are confident and avoid making assumptions.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Provide the following mandatory items in the given order if they exist in the OCR results:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Company
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Invoice number
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Date
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Sub-total
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Any extra charges
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Rounding adjustment
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Total amount
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Itemised result (if any)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">If possible, please provide the best effort list of itemized results with the pricing for each item. 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Please format the result as a string.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">OCR Text: </span><span style="color:#e6db74">{ocr_text}</span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span></code></pre></div><p>By seamlessly configuring OpenAI into our workflow, we gain the ability to extract vital information from the OCR results with remarkable precision and clarity.
Here&rsquo;s how we set up OpenAI:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> openai
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dotenv <span style="color:#f92672">import</span> load_dotenv, find_dotenv
</span></span><span style="display:flex;"><span>_ <span style="color:#f92672">=</span> load_dotenv(find_dotenv()) <span style="color:#75715e"># read local .env file</span>
</span></span><span style="display:flex;"><span>openai<span style="color:#f92672">.</span>api_key <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#39;OPENAI_API_KEY&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> langchain.chat_models <span style="color:#f92672">import</span> ChatOpenAI
</span></span><span style="display:flex;"><span><span style="color:#75715e"># To control the randomness and creativity of the generated</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># text by an LLM, use temperature = 0.0</span>
</span></span><span style="display:flex;"><span>chat <span style="color:#f92672">=</span> ChatOpenAI(temperature<span style="color:#f92672">=</span><span style="color:#ae81ff">0.0</span>)
</span></span><span style="display:flex;"><span>chat
</span></span></code></pre></div><p>To leverage the power of OpenAI, we can now request it to merge the OCR data and generate the desired response based on our template string.
Here&rsquo;s how we can accomplish this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> langchain.prompts <span style="color:#f92672">import</span> ChatPromptTemplate
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prompt_template <span style="color:#f92672">=</span> ChatPromptTemplate<span style="color:#f92672">.</span>from_template(template_string)
</span></span><span style="display:flex;"><span>ocr_inputs <span style="color:#f92672">=</span> prompt_template<span style="color:#f92672">.</span>format_messages(ocr_text<span style="color:#f92672">=</span>ocr_results)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ocr_response <span style="color:#f92672">=</span> chat(ocr_inputs)
</span></span><span style="display:flex;"><span>print(ocr_response<span style="color:#f92672">.</span>content)
</span></span></code></pre></div><p>Here&rsquo;s a sample response generated by OpenAI, demonstrating the merged and formatted output.</p>
<p><img src="/images/ocr/openai-merge-and-format-ocr-result.png" alt="openai-merge-and-format-ocr-result"></p>
<p>With OpenAI&rsquo;s assistance, we are able to seamlessly merge and format the OCR results,
providing us with the desired output that encompasses the essential information extracted from the receipts.
This integration allows us to optimize our data processing workflow and enhance the accuracy and clarity of the extracted data.</p>
<p>For your convenience, this is the formatted output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ocr_response_content <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;&#39;Company: KANPAI
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Invoice number: A23000006 160
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Date: 12/05/2023
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Sub-total: $778.60
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Any extra charges: 10% Svr Chrg $77.85, 8</span><span style="color:#e6db74">% G</span><span style="color:#e6db74">ST $68.51
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Rounding adjustment: Rounding Value 0.01
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Total amount: $924.85
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Itemised result:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Lychee Martini $16.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Lemon Tea-Iced $6.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2 Ginger Beer $8.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">3 Coke $12.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Apple Juice $6.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Cranberry Juice $6.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Seafood Pescatora Pz $19.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Sambal Stingray $24.80
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Sot-ly-laisse $4.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Negima $3.50
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2 *Shio
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Broccoli-fiacon Maki $4.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Mume Combo 4 Kind $14.80
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Tsukune Combo 5 Kind $18.80
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Kushikatsu Shitake $3.80
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 XOSeafood FriedRice $13.80
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2 Crab Meat Fried Rice $23.60
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Acid Egu $2.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">6 Asahi Tower $288.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Cheesy Dashimaki Tam $12.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 TempuraSoftShellCrab $8.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 YuanYane Stingray $24.80
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2 Wasabi Cys Ipc $9.60
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">3 Gyutan Garlic F.Rice $45.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Deep Fried Nankotsu $18.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Dirty Loaded Nachos $18.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Prawn Keropok $8.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Salted Egg Enoki $12.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Span Fries $12.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Squid N Onion Ring $16.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 SwtPotato Mentaika $15.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">1 Thai Pork Belly $14.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2 Fish Bites $30.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">2 Sweet Potato Fries $20.00
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">3 Spicy Pepcornthicken $42.00```
</span></span></span></code></pre></div><hr>
<h2 id="langchain-enhancing-verification-with-llm-math">LangChain: Enhancing Verification with LLM-Math</h2>
<p>In this section, we will leverage the power of LangChain by utilizing its LLM-Math tool. This tool will assist us in verifying the receipt by calculating the amount and comparing it to the OCR results obtained in the earlier section.</p>
<p>Let&rsquo;s start by loading the necessary tools:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> langchain.agents <span style="color:#f92672">import</span> load_tools, initialize_agent
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> langchain.agents <span style="color:#f92672">import</span> AgentType
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> langchain.chat_models <span style="color:#f92672">import</span> ChatOpenAI
</span></span></code></pre></div><p>and initializing the agent:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>llm <span style="color:#f92672">=</span> ChatOpenAI(temperature<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>tools <span style="color:#f92672">=</span> load_tools([<span style="color:#e6db74">&#39;llm-math&#39;</span>], llm<span style="color:#f92672">=</span>llm)
</span></span><span style="display:flex;"><span>agent <span style="color:#f92672">=</span> initialize_agent(
</span></span><span style="display:flex;"><span>    tools, 
</span></span><span style="display:flex;"><span>    llm, 
</span></span><span style="display:flex;"><span>    agent<span style="color:#f92672">=</span>AgentType<span style="color:#f92672">.</span>CHAT_ZERO_SHOT_REACT_DESCRIPTION,
</span></span><span style="display:flex;"><span>    handle_parsing_errors<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>,
</span></span><span style="display:flex;"><span>    verbose <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>)
</span></span></code></pre></div><p>With the agent initialized, we can now use LangChain to verify the results:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>agent<span style="color:#f92672">.</span>run(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;&#34;&#34;Given data ```</span><span style="color:#e6db74">{</span>ocr_response<span style="color:#f92672">.</span>content<span style="color:#e6db74">}</span><span style="color:#e6db74">``` is in the form of key-value pair, eg [KEY]: value
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Ignore the quantity component of each of the given itemized results.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Calculate with these formulas:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">(1) Sub-total (to calculate) = Sum of all itemized results
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">(2) Total amount (to calculate) = Sub-total (1) + Extra Chages - Rounding Value
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Reply in this format:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Sub-total (given)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Sub-total (calculated)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Total amount (given)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Total amount (calculated)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>)
</span></span></code></pre></div><p>With the LangChain agent in action, we perform a comprehensive evaluation of the receipt OCR, summarizing the thought process, calculations, and evaluation results.
Finally, we compare the original and calculated Total Amount values.</p>
<p><img src="/images/ocr/langchain-receipt-ocr-total-amount-compare.png" alt="langchain-receipt-ocr-total-amount-compare"></p>
<p>By incorporating LangChain into our workflow, we can confidently verify the accuracy of the OCR results by performing precise calculations.
This integration adds another layer of validation, ensuring the reliability and integrity of the extracted data.</p>
<p>Congratulations on completing this exploration of receipt OCR using LangChain and OpenAI! You have witnessed the seamless integration of various tools and technologies,
leveraging their combined power to achieve remarkable results. From PyTesseract and OpenCV for OCR to OpenAI for language modeling and
LangChain for mathematical verification, this journey has exemplified the potential of these tools in data processing and analysis.</p>
<p>I hope this journey has been enlightening and inspiring. Feel free to explore further and apply these techniques to other exciting projects.
If you have any more questions or need assistance, please don&rsquo;t hesitate to ask.</p>
<p>Happy exploring!</p>

  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="https://seehiong.github.io/archives/2023/auto-fill-pdf-with-langchain-and-langflow/?ref=footer"><span style="font-weight:bold;"> Previous</span><br>Autofill PDF with LangChain and LangFlow</a>
        
	    
            <div class="next-post">
                <a href="https://seehiong.github.io/archives/2023/how-to-summarize-youtube-videos-in-minutes-1/?ref=footer"><span style="font-weight:bold;">Next </span><br>How to summarize YouTube Videos in Minutes (I)</a>
            </div>
        
    
</div>

  
  <br>
<div class="comments">
    <script>
        const getStoredTheme = () => {
            const themeFromLS = localStorage.getItem("theme");
            const themeFromHugo = document.body.classList.contains("dark-theme") ? "dark" : "light";
            const currentTheme = themeFromLS ? themeFromLS : themeFromHugo;
            return currentTheme;
        };

        const setGiscusTheme = (theme) => {
            const sendMessage = (message) => {
                const iframe = document.querySelector('iframe.giscus-frame');
                if (iframe) {
                    iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
                }
            };
            sendMessage({ setConfig: { theme } });
        };

        document.addEventListener("DOMContentLoaded", () => {
            setGiscusTheme(getStoredTheme());

            const giscusAttributes = {
                "src": "https://giscus.app/client.js",
                "data-repo": "seehiong/seehiong.github.io",
                "data-repo-id": "R_kgDOJg7Puw",
                "data-category": "General",
                "data-category-id": "DIC_kwDOJg7Pu84Cbyhc",
                "data-mapping": "url",
                "data-strict": "0",
                "data-reactions-enabled": "1",
                "data-emit-metadata": "0",
                "data-input-position": "top",
                "data-theme": getStoredTheme(),
                "data-lang": "en",
                "data-loading": "lazy",
                "crossorigin": "anonymous",
                "async": "",
            };

            
            const giscusScript = document.createElement("script");
            Object.entries(giscusAttributes).forEach(
                ([key, value]) => giscusScript.setAttribute(key, value));
            document.querySelector(".comments").appendChild(giscusScript);

            
            const themeSwitcher = document.querySelector(".btn-light-dark");
            if (themeSwitcher) {
                themeSwitcher.addEventListener("click", () => {
                    const currentTheme = getStoredTheme();
                    document.documentElement.classList.toggle("dark", currentTheme);
                    setGiscusTheme(currentTheme);
                });
            }
        });
    </script>
</div>
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#pytesseract--harnessing-optical-character-recognition-power">PyTesseract:  Harnessing Optical Character Recognition Power</a></li>
    <li><a href="#pytesseract-and-opencv-unleashing-combined-power">Pytesseract and OpenCV: Unleashing Combined Power</a></li>
    <li><a href="#openai-unleashing-language-model-power">OpenAI: Unleashing Language Model Power</a></li>
    <li><a href="#langchain-enhancing-verification-with-llm-math">LangChain: Enhancing Verification with LLM-Math</a></li>
  </ul>
</nav>

      
    </div>
</div>
  

        </div>
    </body>
</html>


<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)']]                  
    }
  };
</script>
