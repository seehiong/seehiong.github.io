<!DOCTYPE html>
<html lang="en">
  <head><head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <link rel="icon" href="/img/favicon.ico">
    

    <meta property="og:url" content="https://seehiong.github.io/posts/2023/06/receipt-ocr-with-langchain-openai-and-pytesseract/">
  <meta property="og:site_name" content="See Hiong&#39;s Blog">
  <meta property="og:title" content="Receipt OCR with LangChain, OpenAI and PyTesseract">
  <meta property="og:description" content="Embarking on a receipt OCR adventure inspired by the LangChain for LLM Application Development course, I explore the synergy of LangChain, OpenAI, and PyTesseract. With PyTesseract, I unlock OCR potential using OpenCV and showcase code for comprehensive text extraction. Integrating OpenAI, I create a prompt to merge and format OCR results. LangChain&#39;s LLM-Math tool joins the fray, verifying OCR accuracy by calculating and comparing amounts. Witness the power of combining these technologies for precise receipt data extraction and validation. Dive into the journey, explore the code, and enhance your data processing skills!">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-06-06T20:00:00+08:00">
    <meta property="article:modified_time" content="2023-06-06T20:00:00+08:00">
    <meta property="article:tag" content="OpenAI">
    <meta property="article:tag" content="LangChain">
    <meta property="article:tag" content="OCR">
    <meta property="article:tag" content="PyTesseract">
    <meta property="article:tag" content="AI">
    <meta property="article:tag" content="OpenCV">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Receipt OCR with LangChain, OpenAI and PyTesseract">
  <meta name="twitter:description" content="Embarking on a receipt OCR adventure inspired by the LangChain for LLM Application Development course, I explore the synergy of LangChain, OpenAI, and PyTesseract. With PyTesseract, I unlock OCR potential using OpenCV and showcase code for comprehensive text extraction. Integrating OpenAI, I create a prompt to merge and format OCR results. LangChain&#39;s LLM-Math tool joins the fray, verifying OCR accuracy by calculating and comparing amounts. Witness the power of combining these technologies for precise receipt data extraction and validation. Dive into the journey, explore the code, and enhance your data processing skills!">

  <meta itemprop="name" content="Receipt OCR with LangChain, OpenAI and PyTesseract">
  <meta itemprop="description" content="Embarking on a receipt OCR adventure inspired by the LangChain for LLM Application Development course, I explore the synergy of LangChain, OpenAI, and PyTesseract. With PyTesseract, I unlock OCR potential using OpenCV and showcase code for comprehensive text extraction. Integrating OpenAI, I create a prompt to merge and format OCR results. LangChain&#39;s LLM-Math tool joins the fray, verifying OCR accuracy by calculating and comparing amounts. Witness the power of combining these technologies for precise receipt data extraction and validation. Dive into the journey, explore the code, and enhance your data processing skills!">
  <meta itemprop="datePublished" content="2023-06-06T20:00:00+08:00">
  <meta itemprop="dateModified" content="2023-06-06T20:00:00+08:00">
  <meta itemprop="wordCount" content="1341">
  <meta itemprop="keywords" content="OpenAI,LangChain,OCR,PyTesseract,AI,OpenCV,LLM-Math"><title>Receipt OCR with LangChain, OpenAI and PyTesseract | See Hiong&#39;s Blog</title>

    <link rel="canonical" href="https://seehiong.github.io/posts/2023/06/receipt-ocr-with-langchain-openai-and-pytesseract/">

    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    
    
    <link rel="stylesheet" href="/css/variables.css">
    
    <link rel="stylesheet" href="/css/base.css">
    
    <link rel="stylesheet" href="/css/layout.css">
    
    <link rel="stylesheet" href="/css/header.css">
    
    <link rel="stylesheet" href="/css/header.css">
    
    <link rel="stylesheet" href="/css/cards.css">
    
    <link rel="stylesheet" href="/css/content_elements.css">
    
    <link rel="stylesheet" href="/css/codeblocks.css">
    
    <link rel="stylesheet" href="/css/page_specific.css">
    
    <link rel="stylesheet" href="/css/shortcodes.css">
    
    <link rel="stylesheet" href="/css/components.css">
    
    <link rel="stylesheet" href="/css/animations.css">
    
    <link rel="stylesheet" href="/css/media_queries.css">
    
    <link rel="stylesheet" href="/css/quantum-theme.css">
    

    
    <script>
      (function() {
        var theme = localStorage.getItem('theme');
        var H = document.documentElement;
        if (theme === 'dark-mode') {
          H.classList.add('dark-mode');
        } else if (theme === 'light-mode') {
          H.classList.remove('dark-mode');
        } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          H.classList.add('dark-mode');
        }
      })();
    </script>
</head></head>
  <body class="page-article"><nav class="nav">
  <div class="nav-wrapper">
    <div class="nav-content-wrapper">
      <div class="nav-content">
        <a href="/" class="nav-logo-link" title="See Hiong&#39;s Blog - Home">
          
          
          <img src="/images/blog_logo.png" alt="See Hiong&#39;s Blog Logo" class="nav-logo-image">
        </a>
        <div class="nav-menu">
          <div class="nav-item-wrapper">
            
            
            <a href="/posts/" class="nav-item-content active">Archives</a>
            
          </div>
          
          
          <div class="nav-item-wrapper">
            <a href="/tags/" class="nav-item-content ">Tags</a>
          </div>
          <div class="nav-item-wrapper">
            <a href="/about/" class="nav-item-content ">About</a>
          </div>
          <div class="nav-item-wrapper nav-search-toggle-wrapper">
            <button id="nav-search-toggle" class="nav-item-button" aria-label="Toggle search" title="Search">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="currentColor" class="nav-item-icon">
                <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5A6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
              </svg>
            </button>
          </div>
          
          
          <button id="theme-toggle" class="nav-item-button" aria-label="Toggle theme"></button> 
        </div>
      </div>
    </div>
  </div>
</nav>


<script>
  document.addEventListener('DOMContentLoaded', function () {
    const themeToggle = document.getElementById('theme-toggle');
    const H = document.documentElement; 

    if (H.classList.contains('dark-mode')) {
      themeToggle.textContent = 'Light Mode';
    } else {
      themeToggle.textContent = 'Dark Mode';
    }

    themeToggle.addEventListener('click', function() {
      H.classList.toggle('dark-mode');
      if (H.classList.contains('dark-mode')) {
        localStorage.setItem('theme', 'dark-mode');
        themeToggle.textContent = 'Light Mode';
      } else {
        localStorage.setItem('theme', 'light-mode');
        themeToggle.textContent = 'Dark Mode';
      }
    });
  });
</script><div id="content-wrapper">
        <main class="container" id="main-content">
<div class="main-content-area">
  <article class="post-layout container">

    <header class="post-header">
      <h1 class="post-title">Receipt OCR with LangChain, OpenAI and PyTesseract</h1>

      <div class="post-meta">
        <span class="post-meta__date">
          <time datetime="2023-06-06T20:00:00&#43;08:00">June 6, 2023</time>
        </span>

        
          <span class="post-meta__author">Written by See Hiong</span>
        

        
          <span class="post-meta__tags">
            In:
            
              <a href="/tags/openai">OpenAI</a>
            
              , <a href="/tags/langchain">LangChain</a>
            
              , <a href="/tags/ocr">OCR</a>
            
              , <a href="/tags/pytesseract">PyTesseract</a>
            
              , <a href="/tags/ai">AI</a>
            
              , <a href="/tags/opencv">OpenCV</a>
            
              , <a href="/tags/llm-math">LLM-Math</a>
            
          </span>
        

        
      </div>
    </header>

    
      
      
      <div class="post-cover-container post-cover--artistic-blur-wrapper">
        
          <div class="post-cover-blur-background" style="--bg-image: url('/images/ocr/receipt-ocr-with-langchain-and-openai.png');"></div>
          <img src="/images/ocr/receipt-ocr-with-langchain-and-openai.png" alt="Receipt OCR with LangChain, OpenAI and PyTesseract cover image" class="post-cover-image post-cover-image--artistic-blur">
        
      </div>
    

    <section class="post-content">
      <p>Recently, I embarked on an exhilarating journey into the realm of receipt OCR using LangChain and OpenAI, inspired by the captivating course on 






  <a href="https://learn.deeplearning.ai/langchain/lesson/1/introduction" target="_blank" rel="noopener noreferrer" >LangChain for LLM Application Development</a>
. This exploration allowed me to unlock the full potential of PyTesseract, an extraordinary Python tool that serves as my guiding light for optical character recognition (OCR). By harnessing the power of OpenCV and seamlessly integrating OpenAI into the workflow, I aimed to compile the most optimal OCR results and validate them using LangChain&rsquo;s impressive llm-math tool. Join me on this exciting adventure as we unravel the intricacies of receipt OCR and discover the true potential of LangChain, OpenAI, and PyTesseract.</p>
<h2 id="pytesseract--harnessing-optical-character-recognition-power">PyTesseract:  Harnessing Optical Character Recognition Power</h2>
<p>To begin my exploration, I first ensured I had all the necessary tools at my disposal. Depending on the operating system, the 






  <a href="https://github.com/UB-Mannheim/tesseract/wiki" target="_blank" rel="noopener noreferrer" >Tesseract installer for Windows</a>
 can be downloaded from here. With the installation complete, I equipped myself with essential Python packages by executing the following command:</p>






<div class="code-block-wrapper">
  <div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pip install pytesseract pillow opencv<span style="color:#0550ae">-</span>python</span></span></code></pre></div>
  <button class="copy-code-button" aria-label="Copy code to clipboard" title="Copy code">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="copy-icon">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="check-icon" style="display:none;">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
    <span class="copy-text">Copy</span>
  </button>
</div><p>Now that everything was set, I put PyTesseract to the test using a sample receipt. Here&rsquo;s a glimpse of the image we&rsquo;ll be working with:</p>


































 
  
  





  <img src="/images/ocr/sample-receipt-ocr.jpeg"   alt="sample-receipt-ocr" class="sc-image sc-image-default"
       >


<p>To witness the capabilities of PyTesseract firsthand, I present you with the following code snippet:</p>






<div class="code-block-wrapper">
  <div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#cf222e">from</span> <span style="color:#24292e">PIL</span> <span style="color:#cf222e">import</span> Image
</span></span><span style="display:flex;"><span><span style="color:#cf222e">import</span> <span style="color:#24292e">pytesseract</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a"># Defines the abosulate path to the executable</span>
</span></span><span style="display:flex;"><span>pytesseract<span style="color:#0550ae">.</span>pytesseract<span style="color:#0550ae">.</span>tesseract_cmd <span style="color:#0550ae">=</span> <span style="color:#0a3069">r</span><span style="color:#0a3069">&#39;C:/Program Files/Tesseract-OCR/tesseract.exe&#39;</span>
</span></span><span style="display:flex;"><span>file <span style="color:#0550ae">=</span> <span style="color:#0a3069">&#39;C:/ocr/sample-receipt-ocr.jpeg&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>img <span style="color:#0550ae">=</span> Image<span style="color:#0550ae">.</span>open<span style="color:#1f2328">(</span>file<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#6639ba">print</span><span style="color:#1f2328">(</span>pytesseract<span style="color:#0550ae">.</span>image_to_string<span style="color:#1f2328">(</span>img<span style="color:#1f2328">))</span></span></span></code></pre></div>
  <button class="copy-code-button" aria-label="Copy code to clipboard" title="Copy code">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="copy-icon">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="check-icon" style="display:none;">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
    <span class="copy-text">Copy</span>
  </button>
</div><p>Running this code for the first time, I eagerly awaited the results:</p>


































 
  
  





  <img src="/images/ocr/tesseract-ocr-first-run.png"   alt="tesseract-ocr-first-run" class="sc-image sc-image-default"
       >


<p>Join me on this exciting journey as we delve deeper into the remarkable capabilities of PyTesseract, uncovering its potential to extract text from images with unparalleled precision and accuracy.</p>
<h2 id="pytesseract-and-opencv-unleashing-combined-power">Pytesseract and OpenCV: Unleashing Combined Power</h2>
<p>As I continued my exploration with the sample receipt, I refined my code to generate a comprehensive dictionary containing the OCR results obtained through various methods. Let me share with you the code responsible for this accomplishment:</p>






<div class="code-block-wrapper">
  <div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#cf222e">from</span> <span style="color:#24292e">PIL</span> <span style="color:#cf222e">import</span> Image
</span></span><span style="display:flex;"><span><span style="color:#cf222e">import</span> <span style="color:#24292e">pytesseract</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">import</span> <span style="color:#24292e">cv2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a"># Set Tesseract executable path</span>
</span></span><span style="display:flex;"><span>pytesseract<span style="color:#0550ae">.</span>pytesseract<span style="color:#0550ae">.</span>tesseract_cmd <span style="color:#0550ae">=</span> <span style="color:#0a3069">r</span><span style="color:#0a3069">&#39;C:/Program Files/Tesseract-OCR/tesseract.exe&#39;</span>
</span></span><span style="display:flex;"><span>file <span style="color:#0550ae">=</span> <span style="color:#0a3069">&#39;C:/ocr/sample-receipt-ocr.jpeg&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">def</span> <span style="color:#6639ba">perform_ocr</span><span style="color:#1f2328">(</span>image<span style="color:#1f2328">,</span> name<span style="color:#1f2328">):</span>
</span></span><span style="display:flex;"><span>    text <span style="color:#0550ae">=</span> pytesseract<span style="color:#0550ae">.</span>image_to_string<span style="color:#1f2328">(</span>image<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>    ocr_results<span style="color:#0550ae">.</span>append<span style="color:#1f2328">({</span><span style="color:#0a3069">&#39;name&#39;</span><span style="color:#1f2328">:</span> name<span style="color:#1f2328">,</span> <span style="color:#0a3069">&#39;text&#39;</span><span style="color:#1f2328">:</span> text<span style="color:#1f2328">})</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a"># Read the image using OpenCV</span>
</span></span><span style="display:flex;"><span>cvImage <span style="color:#0550ae">=</span> cv2<span style="color:#0550ae">.</span>imread<span style="color:#1f2328">(</span>file<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a"># Initialize OCR results list</span>
</span></span><span style="display:flex;"><span>ocr_results <span style="color:#0550ae">=</span> <span style="color:#1f2328">[]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a"># Perform OCR on the original image</span>
</span></span><span style="display:flex;"><span>fileImage <span style="color:#0550ae">=</span> Image<span style="color:#0550ae">.</span>open<span style="color:#1f2328">(</span>file<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>perform_ocr<span style="color:#1f2328">(</span>fileImage<span style="color:#1f2328">,</span> <span style="color:#0a3069">&#39;FILE&#39;</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a"># Perform OCR on the OpenCV image</span>
</span></span><span style="display:flex;"><span>perform_ocr<span style="color:#1f2328">(</span>cvImage<span style="color:#1f2328">,</span> <span style="color:#0a3069">&#39;CV&#39;</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a"># Perform OCR on the grayscale image</span>
</span></span><span style="display:flex;"><span>gray <span style="color:#0550ae">=</span> cv2<span style="color:#0550ae">.</span>cvtColor<span style="color:#1f2328">(</span>cvImage<span style="color:#1f2328">,</span> cv2<span style="color:#0550ae">.</span>COLOR_BGR2GRAY<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>perform_ocr<span style="color:#1f2328">(</span>gray<span style="color:#1f2328">,</span> <span style="color:#0a3069">&#39;GRAY&#39;</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a"># Perform OCR on the thresholded image</span>
</span></span><span style="display:flex;"><span>_<span style="color:#1f2328">,</span> threshold <span style="color:#0550ae">=</span> cv2<span style="color:#0550ae">.</span>threshold<span style="color:#1f2328">(</span>gray<span style="color:#1f2328">,</span> <span style="color:#0550ae">0</span><span style="color:#1f2328">,</span> <span style="color:#0550ae">255</span><span style="color:#1f2328">,</span> cv2<span style="color:#0550ae">.</span>THRESH_BINARY <span style="color:#0550ae">|</span> cv2<span style="color:#0550ae">.</span>THRESH_OTSU<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>perform_ocr<span style="color:#1f2328">(</span>threshold<span style="color:#1f2328">,</span> <span style="color:#0a3069">&#39;THRESHOLD&#39;</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#57606a"># Perform OCR on the denoised image</span>
</span></span><span style="display:flex;"><span>denoised <span style="color:#0550ae">=</span> cv2<span style="color:#0550ae">.</span>medianBlur<span style="color:#1f2328">(</span>cvImage<span style="color:#1f2328">,</span> <span style="color:#0550ae">3</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>perform_ocr<span style="color:#1f2328">(</span>denoised<span style="color:#1f2328">,</span> <span style="color:#0a3069">&#39;DENOISED&#39;</span><span style="color:#1f2328">)</span></span></span></code></pre></div>
  <button class="copy-code-button" aria-label="Copy code to clipboard" title="Copy code">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="copy-icon">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="check-icon" style="display:none;">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
    <span class="copy-text">Copy</span>
  </button>
</div><p>Throughout this process, I meticulously experimented with different methods to extract the text from the receipt.
With each method, I added the results to a dictionary, capturing both the name of the method and the corresponding OCR output.</p>
<h2 id="openai-unleashing-language-model-power">OpenAI: Unleashing Language Model Power</h2>
<p>Allow me to introduce the next phase of our exploration: OpenAI. We have carefully crafted a prompt that will guide us through
the integration of OpenAI into our OCR (Optical Character Recognition) use case:</p>






<div class="code-block-wrapper">
  <div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>template_string <span style="color:#0550ae">=</span> <span style="color:#0a3069">&#34;&#34;&#34;The ocr_result variable stores a list of results obtained from the OCR (Optical Character Recognition) process. </span><span style="color:#0a3069">\
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069"></span><span style="color:#0a3069">Each item in the list represents a specific configuration or variation of the OCR process, along with the corresponding extracted text.
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Please compare and merge the OCR results only when you are confident and avoid making assumptions.
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Provide the following mandatory items in the given order if they exist in the OCR results:
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Company
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Invoice number
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Date
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Sub-total
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Any extra charges
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Rounding adjustment
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Total amount
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Itemised result (if any)
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">If possible, please provide the best effort list of itemized results with the pricing for each item. 
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Please format the result as a string.
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">OCR Text: </span><span style="color:#0a3069">{ocr_text}</span><span style="color:#0a3069">
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">&#34;&#34;&#34;</span></span></span></code></pre></div>
  <button class="copy-code-button" aria-label="Copy code to clipboard" title="Copy code">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="copy-icon">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="check-icon" style="display:none;">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
    <span class="copy-text">Copy</span>
  </button>
</div><p>By seamlessly configuring OpenAI into our workflow, we gain the ability to extract vital information from the OCR results with remarkable precision and clarity.
Here&rsquo;s how we set up OpenAI:</p>






<div class="code-block-wrapper">
  <div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#cf222e">import</span> <span style="color:#24292e">os</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">import</span> <span style="color:#24292e">openai</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">from</span> <span style="color:#24292e">dotenv</span> <span style="color:#cf222e">import</span> load_dotenv<span style="color:#1f2328">,</span> find_dotenv
</span></span><span style="display:flex;"><span>_ <span style="color:#0550ae">=</span> load_dotenv<span style="color:#1f2328">(</span>find_dotenv<span style="color:#1f2328">())</span> <span style="color:#57606a"># read local .env file</span>
</span></span><span style="display:flex;"><span>openai<span style="color:#0550ae">.</span>api_key <span style="color:#0550ae">=</span> os<span style="color:#0550ae">.</span>environ<span style="color:#1f2328">[</span><span style="color:#0a3069">&#39;OPENAI_API_KEY&#39;</span><span style="color:#1f2328">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">from</span> <span style="color:#24292e">langchain.chat_models</span> <span style="color:#cf222e">import</span> ChatOpenAI
</span></span><span style="display:flex;"><span><span style="color:#57606a"># To control the randomness and creativity of the generated</span>
</span></span><span style="display:flex;"><span><span style="color:#57606a"># text by an LLM, use temperature = 0.0</span>
</span></span><span style="display:flex;"><span>chat <span style="color:#0550ae">=</span> ChatOpenAI<span style="color:#1f2328">(</span>temperature<span style="color:#0550ae">=</span><span style="color:#0550ae">0.0</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>chat</span></span></code></pre></div>
  <button class="copy-code-button" aria-label="Copy code to clipboard" title="Copy code">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="copy-icon">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="check-icon" style="display:none;">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
    <span class="copy-text">Copy</span>
  </button>
</div><p>To leverage the power of OpenAI, we can now request it to merge the OCR data and generate the desired response based on our template string.
Here&rsquo;s how we can accomplish this:</p>






<div class="code-block-wrapper">
  <div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#cf222e">from</span> <span style="color:#24292e">langchain.prompts</span> <span style="color:#cf222e">import</span> ChatPromptTemplate
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>prompt_template <span style="color:#0550ae">=</span> ChatPromptTemplate<span style="color:#0550ae">.</span>from_template<span style="color:#1f2328">(</span>template_string<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>ocr_inputs <span style="color:#0550ae">=</span> prompt_template<span style="color:#0550ae">.</span>format_messages<span style="color:#1f2328">(</span>ocr_text<span style="color:#0550ae">=</span>ocr_results<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ocr_response <span style="color:#0550ae">=</span> chat<span style="color:#1f2328">(</span>ocr_inputs<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#6639ba">print</span><span style="color:#1f2328">(</span>ocr_response<span style="color:#0550ae">.</span>content<span style="color:#1f2328">)</span></span></span></code></pre></div>
  <button class="copy-code-button" aria-label="Copy code to clipboard" title="Copy code">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="copy-icon">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="check-icon" style="display:none;">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
    <span class="copy-text">Copy</span>
  </button>
</div><p>Here&rsquo;s a sample response generated by OpenAI, demonstrating the merged and formatted output.</p>


































 
  
  





  <img src="/images/ocr/openai-merge-and-format-ocr-result.png"   alt="openai-merge-and-format-ocr-result" class="sc-image sc-image-default"
       >


<p>With OpenAI&rsquo;s assistance, we are able to seamlessly merge and format the OCR results,
providing us with the desired output that encompasses the essential information extracted from the receipts.
This integration allows us to optimize our data processing workflow and enhance the accuracy and clarity of the extracted data.</p>
<p>For your convenience, this is the formatted output:</p>






<div class="code-block-wrapper">
  <div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ocr_response_content <span style="color:#0550ae">=</span> <span style="color:#0a3069">&#39;&#39;&#39;Company: KANPAI
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Invoice number: A23000006 160
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Date: 12/05/2023
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Sub-total: $778.60
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Any extra charges: 10% Svr Chrg $77.85, 8</span><span style="color:#0a3069">% G</span><span style="color:#0a3069">ST $68.51
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Rounding adjustment: Rounding Value 0.01
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Total amount: $924.85
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Itemised result:
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Lychee Martini $16.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Lemon Tea-Iced $6.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">2 Ginger Beer $8.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">3 Coke $12.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Apple Juice $6.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Cranberry Juice $6.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Seafood Pescatora Pz $19.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Sambal Stingray $24.80
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Sot-ly-laisse $4.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Negima $3.50
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">2 *Shio
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Broccoli-fiacon Maki $4.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Mume Combo 4 Kind $14.80
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Tsukune Combo 5 Kind $18.80
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Kushikatsu Shitake $3.80
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 XOSeafood FriedRice $13.80
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">2 Crab Meat Fried Rice $23.60
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Acid Egu $2.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">6 Asahi Tower $288.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Cheesy Dashimaki Tam $12.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 TempuraSoftShellCrab $8.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 YuanYane Stingray $24.80
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">2 Wasabi Cys Ipc $9.60
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">3 Gyutan Garlic F.Rice $45.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Deep Fried Nankotsu $18.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Dirty Loaded Nachos $18.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Prawn Keropok $8.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Salted Egg Enoki $12.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Span Fries $12.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Squid N Onion Ring $16.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 SwtPotato Mentaika $15.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">1 Thai Pork Belly $14.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">2 Fish Bites $30.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">2 Sweet Potato Fries $20.00
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">3 Spicy Pepcornthicken $42.00```</span></span></span></code></pre></div>
  <button class="copy-code-button" aria-label="Copy code to clipboard" title="Copy code">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="copy-icon">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="check-icon" style="display:none;">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
    <span class="copy-text">Copy</span>
  </button>
</div><h2 id="langchain-enhancing-verification-with-llm-math">LangChain: Enhancing Verification with LLM-Math</h2>
<p>In this section, we will leverage the power of LangChain by utilizing its LLM-Math tool. This tool will assist us in verifying the receipt by calculating the amount and comparing it to the OCR results obtained in the earlier section.</p>
<p>Let&rsquo;s start by loading the necessary tools:</p>






<div class="code-block-wrapper">
  <div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#cf222e">from</span> <span style="color:#24292e">langchain.agents</span> <span style="color:#cf222e">import</span> load_tools<span style="color:#1f2328">,</span> initialize_agent
</span></span><span style="display:flex;"><span><span style="color:#cf222e">from</span> <span style="color:#24292e">langchain.agents</span> <span style="color:#cf222e">import</span> AgentType
</span></span><span style="display:flex;"><span><span style="color:#cf222e">from</span> <span style="color:#24292e">langchain.chat_models</span> <span style="color:#cf222e">import</span> ChatOpenAI</span></span></code></pre></div>
  <button class="copy-code-button" aria-label="Copy code to clipboard" title="Copy code">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="copy-icon">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="check-icon" style="display:none;">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
    <span class="copy-text">Copy</span>
  </button>
</div><p>and initializing the agent:</p>






<div class="code-block-wrapper">
  <div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>llm <span style="color:#0550ae">=</span> ChatOpenAI<span style="color:#1f2328">(</span>temperature<span style="color:#0550ae">=</span><span style="color:#0550ae">0</span><span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>tools <span style="color:#0550ae">=</span> load_tools<span style="color:#1f2328">([</span><span style="color:#0a3069">&#39;llm-math&#39;</span><span style="color:#1f2328">],</span> llm<span style="color:#0550ae">=</span>llm<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>agent <span style="color:#0550ae">=</span> initialize_agent<span style="color:#1f2328">(</span>
</span></span><span style="display:flex;"><span>    tools<span style="color:#1f2328">,</span> 
</span></span><span style="display:flex;"><span>    llm<span style="color:#1f2328">,</span> 
</span></span><span style="display:flex;"><span>    agent<span style="color:#0550ae">=</span>AgentType<span style="color:#0550ae">.</span>CHAT_ZERO_SHOT_REACT_DESCRIPTION<span style="color:#1f2328">,</span>
</span></span><span style="display:flex;"><span>    handle_parsing_errors<span style="color:#0550ae">=</span><span style="color:#cf222e">True</span><span style="color:#1f2328">,</span>
</span></span><span style="display:flex;"><span>    verbose <span style="color:#0550ae">=</span> <span style="color:#cf222e">True</span><span style="color:#1f2328">)</span></span></span></code></pre></div>
  <button class="copy-code-button" aria-label="Copy code to clipboard" title="Copy code">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="copy-icon">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="check-icon" style="display:none;">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
    <span class="copy-text">Copy</span>
  </button>
</div><p>With the agent initialized, we can now use LangChain to verify the results:</p>






<div class="code-block-wrapper">
  <div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>agent<span style="color:#0550ae">.</span>run<span style="color:#1f2328">(</span><span style="color:#0a3069">f</span><span style="color:#0a3069">&#34;&#34;&#34;Given data ```</span><span style="color:#0a3069">{</span>ocr_response<span style="color:#0550ae">.</span>content<span style="color:#0a3069">}</span><span style="color:#0a3069">``` is in the form of key-value pair, eg [KEY]: value
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Ignore the quantity component of each of the given itemized results.
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Calculate with these formulas:
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">(1) Sub-total (to calculate) = Sum of all itemized results
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">(2) Total amount (to calculate) = Sub-total (1) + Extra Chages - Rounding Value
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Reply in this format:
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Sub-total (given)
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Sub-total (calculated)
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Total amount (given)
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">Total amount (calculated)
</span></span></span><span style="display:flex;"><span><span style="color:#0a3069">&#34;&#34;&#34;</span><span style="color:#1f2328">)</span></span></span></code></pre></div>
  <button class="copy-code-button" aria-label="Copy code to clipboard" title="Copy code">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="copy-icon">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="check-icon" style="display:none;">
      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
    </svg>
    <span class="copy-text">Copy</span>
  </button>
</div><p>With the LangChain agent in action, we perform a comprehensive evaluation of the receipt OCR, summarizing the thought process, calculations, and evaluation results.
Finally, we compare the original and calculated Total Amount values.</p>


































 
  
  





  <img src="/images/ocr/langchain-receipt-ocr-total-amount-compare.png"   alt="langchain-receipt-ocr-total-amount-compare" class="sc-image sc-image-default"
       >


<p>By incorporating LangChain into our workflow, we can confidently verify the accuracy of the OCR results by performing precise calculations.
This integration adds another layer of validation, ensuring the reliability and integrity of the extracted data.</p>
<p>Congratulations on completing this exploration of receipt OCR using LangChain and OpenAI! You have witnessed the seamless integration of various tools and technologies,
leveraging their combined power to achieve remarkable results. From PyTesseract and OpenCV for OCR to OpenAI for language modeling and
LangChain for mathematical verification, this journey has exemplified the potential of these tools in data processing and analysis.</p>
<p>I hope this journey has been enlightening and inspiring. Feel free to explore further and apply these techniques to other exciting projects.
If you have any more questions or need assistance, please don&rsquo;t hesitate to ask.</p>
<p>Happy exploring!</p>

    </section>

    <nav class="post-navigation">
      <div class="nav-links">
        
          <div class="nav-previous">
            <a href="/posts/2023/05/autofill-pdf-with-langchain-and-langflow/" rel="prev">
              <span class="meta-nav">← Previous</span>
              <span class="post-title">Autofill PDF with LangChain and LangFlow</span>
            </a>
          </div>
        
        
          <div class="nav-next">
            <a href="/posts/2023/06/how-to-summarize-youtube-videos-in-minutes-i/" rel="next">
              <span class="meta-nav">Next →</span>
              <span class="post-title">How to summarize YouTube Videos in Minutes (I)</span>
            </a>
          </div>
        
      </div>
    </nav>

    
<div class="giscus-comments-container">
</div>

<script>
  (function() {
    'use strict';

    const getGiscusTheme = () => {
      const storedTheme = localStorage.getItem('theme'); 
      if (storedTheme) {
        return storedTheme === 'dark-mode' ? 'dark' : 'light';
      }
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    };

    const setGiscusFrameTheme = (theme) => {
      const iframe = document.querySelector('iframe.giscus-frame');
      if (iframe && iframe.contentWindow) {
        iframe.contentWindow.postMessage({ giscus: { setConfig: { theme: theme } } }, 'https://giscus.app');
      }
    };

    const loadGiscus = () => {
      const giscusContainer = document.querySelector('.giscus-comments-container');
      if (!giscusContainer) {
        console.warn('Giscus container not found.');
        return;
      }

      while (giscusContainer.firstChild) {
        giscusContainer.removeChild(giscusContainer.firstChild);
      }

      const giscusScript = document.createElement('script');
      const giscusAttributes = {
        "src": "https://giscus.app/client.js",
        "data-repo":             "seehiong\/seehiong.github.io",
        "data-repo-id":          "R_kgDOJg7Puw",
        "data-category":         "General",
        "data-category-id":      "DIC_kwDOJg7Pu84Cbyhc",
        "data-mapping":          "url", 
        "data-strict":           "0",
        "data-reactions-enabled":"1",
        "data-emit-metadata":    "0",
        "data-input-position":   "top", 
        "data-theme":            getGiscusTheme(), 
        "data-lang":             "en",
        "data-loading":          "lazy",
        "crossorigin":           "anonymous",
        "async":                 "true", 
      };

      if (!giscusAttributes["data-repo"] || !giscusAttributes["data-repo-id"] || !giscusAttributes["data-category-id"]) {
          console.error("Giscus parameters (giscusRepo, giscusRepoId, giscusCategoryId) are not configured in hugo.toml.");
          giscusContainer.innerHTML = "<p style='color: var(--text-secondary);'>Giscus comments are not configured correctly. Please check site parameters.</p>";
          return;
      }

      Object.entries(giscusAttributes).forEach(
        ([key, value]) => giscusScript.setAttribute(key, value)
      );
      giscusContainer.appendChild(giscusScript);
    };

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadGiscus);
    } else {
        loadGiscus();
    }

    const htmlElement = document.documentElement;
    const observer = new MutationObserver((mutationsList) => {
      for (const mutation of mutationsList) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
          setGiscusFrameTheme(getGiscusTheme());
        }
      }
    });
    observer.observe(htmlElement, { attributes: true });

  })();
</script>


  </article>
</div>
</main>
    </div>

    
    <div id="search-modal-overlay" class="search-modal-overlay" style="display: none;">
      <div id="search-modal-content" class="search-modal-content">
        <button id="search-modal-close" class="search-modal-close" aria-label="Close search" title="Close search">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </button>
        <input type="search" id="modal-search-input" class="modal-search-input" placeholder="Search content..." aria-label="Search input">
        <div id="modal-search-results" class="modal-search-results">
        </div>
      </div>
    </div>
    

  <script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js" defer></script>
  <script>
    (function() {
      'use strict';

      window.addEventListener('DOMContentLoaded', () => {
        const searchModalOverlay = document.getElementById('search-modal-overlay');
        const searchModalContent = document.getElementById('search-modal-content');
        const searchModalCloseButton = document.getElementById('search-modal-close');
        const searchToggleButton = document.getElementById('nav-search-toggle');
        const searchInputTarget = document.getElementById('modal-search-input');
        const searchResultsTarget = document.getElementById('modal-search-results');

        let fuseInstance = null;
        let searchData = [];

        const loadSearchData = async () => {
          if (searchData.length === 0 && !fuseInstance) {
            try {
              const response = await fetch('\/index.json');
              if (!response.ok) {
                throw new Error(`HTTP error loading index.json! status: ${response.status}`);
              }
              searchData = await response.json();
              initializeFuse();
            } catch (e) {
              console.error("[SearchSetup] Error loading search data:", e);
              if (searchResultsTarget) searchResultsTarget.innerHTML = "<p>Error loading search index.</p>";
            }
          } else if (searchData.length > 0 && !fuseInstance){
            initializeFuse();
          }
        };

        const initializeFuse = () => {
          if (searchData.length > 0 && !fuseInstance) {
            const options = {
              keys: [
                { name: 'title', weight: 0.7 }, { name: 'summary', weight: 0.5 },
                { name: 'content', weight: 0.3 }, { name: 'tags', weight: 0.4 }
              ],
              includeScore: true, threshold: 0.4, minMatchCharLength: 2,
            };
            fuseInstance = new Fuse(searchData, options);
          }
        };

        const performSearch = () => {
          if (!fuseInstance || !searchInputTarget || !searchResultsTarget) return;
          const query = searchInputTarget.value.trim();
          searchResultsTarget.innerHTML = '';
          if (query.length < 2) return;

          const results = fuseInstance.search(query);
          if (results.length > 0) {
            const ul = document.createElement('ul');
            ul.className = 'search-results-list';
            results.slice(0, 10).forEach(result => {
              const item = result.item;
              const li = document.createElement('li');
              li.className = 'search-result-item';
              const a = document.createElement('a');
              a.href = item.permalink;
              a.textContent = item.title;
              li.appendChild(a);
              ul.appendChild(li);
            });
            searchResultsTarget.appendChild(ul);
          } else {
            searchResultsTarget.innerHTML = '<p>No results found.</p>';
          }
        };

        const openSearchModal = async () => {
          await loadSearchData();
          if (searchInputTarget) searchInputTarget.value = '';
          if (searchResultsTarget) searchResultsTarget.innerHTML = '';

          if (searchModalOverlay) {
            searchModalOverlay.style.display = 'flex';
            setTimeout(() => searchModalOverlay.classList.add('active'), 10);
          } else { return; }

          if (searchInputTarget) setTimeout(() => searchInputTarget.focus(), 50);
          if (searchToggleButton) searchToggleButton.classList.add('active');
        };

        const closeSearchModal = () => {
          if (searchModalOverlay) {
            searchModalOverlay.classList.remove('active');
            setTimeout(() => searchModalOverlay.style.display = 'none', 300);
          }
          if (searchToggleButton) searchToggleButton.classList.remove('active');
        };

        if (searchToggleButton) {
          searchToggleButton.addEventListener('click', (e) => {
            e.stopPropagation();
            if (searchModalOverlay && searchModalOverlay.classList.contains('active')) {
              closeSearchModal();
            } else {
              openSearchModal();
            }
          });
        } else { console.error("[SearchSetup] #nav-search-toggle button not found."); }

        if (searchModalCloseButton) { searchModalCloseButton.addEventListener('click', closeSearchModal); }
        if (searchModalOverlay && searchModalContent) {
          searchModalOverlay.addEventListener('click', (event) => {
            if (event.target === searchModalOverlay) closeSearchModal();
          });
        }
        document.addEventListener('keydown', (event) => {
          if (event.key === 'Escape' && searchModalOverlay && searchModalOverlay.classList.contains('active')) {
            closeSearchModal();
          }
        });
        if (searchInputTarget) {
          let debounceTimer;
          searchInputTarget.addEventListener('input', () => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(performSearch, 300);
          });
        }
      });
    })();
  </script>

    

    

  <script>
    MathJax = {
      tex: {
        displayMath: [['\\[', '\\]'], ['$$', '$$']], 
        inlineMath: [['\\(', '\\)']], 
        processEscapes: true,
        processEnvironments: true,
        tags: 'ams' 
      },
      svg: {
        fontCache: 'global' 
      },
      chtml: {
        fontURL: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/output/chtml/fonts/woff-v2'
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'], 
        ignoreHtmlClass: 'tex2jax_ignore', 
        processHtmlClass: 'tex2jax_process'
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<footer class="footer-main simplified-footer">
  <div class="content-body footer-wraper">
    <div class="footer-box">
      <div class="footer-content">
        <div class="copyright-line">
          Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a> © 2025 See Hiong. All rights reserved.
        </div>
        <div class="social-links">
          
            <a href="https://github.com/seehiong" target="_blank" title="GitHub" class="social-link" aria-label="GitHub">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            </a>
          
          
            <a href="https://www.linkedin.com/in/seehiong/" target="_blank" title="LinkedIn" class="social-link" aria-label="LinkedIn">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
            </a>
          
          
            <a href="/index.xml" target="_blank" title="RSS" class="social-link" aria-label="RSS Feed">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg>
            </a>
          
        </div>
      </div>
    </div>
  </div>
</footer>
        <script src="/js/animation.js" defer></script>
    
        <script src="/js/code-copy.js" defer></script>
    
        <script src="/js/scroll-header.js" defer></script>
       
  </body>
</html>